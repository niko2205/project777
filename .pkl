import joblib
from sklearn.pipeline import Pipeline
from sklearn.impute import SimpleImputer
from sklearn.preprocessing import StandardScaler
from sklearn.linear_model import LinearRegression
import pandas as pd
import numpy as np

# Загрузка данных
data = pd.read_csv('data.csv')

# Разделение данных на признаки и целевую переменную
X = data.drop('loan_amount', axis=1)
y = data['loan_amount']

# Создание модели
pipeline = Pipeline([
    ('imputer', SimpleImputer(strategy='median')),
    ('scaler', StandardScaler()),
    ('model', LinearRegression())
])

# Обучение модели
pipeline.fit(X, y)

# Сохранение модели в файл
joblib.dump(pipeline, 'model.pkl')
